- name: Verify AWS logs
  description: Verify that the engine accepts AWS sample logs
  configuration_parameters:
    cfg: None
  metadata:
    events:
      - 2019-11-27 15:09:34,491 | INFO  | KahaDB is version 6 | org.apache.activemq.store.wawa.MessageDatabase | main
      - 2019-11-27 15:09:34,531 | INFO  | PListStore:[/opt/activemq/data/localhost/tmp_storage] started | org.apache.activemq.store.wawa.plist.PListStoreImpl | main
      - 2019-11-27 15:09:34,690 | INFO  | Apache ActiveMQ 5.15.9 (localhost, ID:5323986a6080-37033-1572227374550-0:1) is starting | org.apache.activemq.broker.BrokerService | main
      - 2019-11-27 15:09:34,712 | ERROR | Failed to start Apache ActiveMQ (localhost, ID:5323986a6080-37033-1572227374550-0:1) | org.apache.activemq.broker.BrokerService | main at org.apache.activemq.util.IOExceptionSupport.create(IOExceptionSupport.java:28)[activemq-client-5.15.9.jar:5.15.9] at org.apache.activemq.broker.BrokerService.registerConnectorMBean(BrokerService.java:2264)[activemq-broker-5.15.9.jar:5.15.9] at org.apache.activemq.broker.BrokerService.startTransportConnector(BrokerService.java:2744)[activemq-broker-5.15.9.jar:5.15.9] at org.apache.activemq.broker.BrokerService.startAllConnectors(BrokerService.java:2640)[activemq-broker-5.15.9.jar:5.15.9] at org.apache.activemq.broker.BrokerService.doStartBroker(BrokerService.java:771)[activemq-broker-5.15.9.jar:5.15.9] at org.apache.activemq.broker.BrokerService.startBroker(BrokerService.java:733)[activemq-broker-5.15.9.jar:5.15.9] at org.apache.activemq.broker.BrokerService.start(BrokerService.java:636)[activemq-broker-5.15.9.jar:5.15.9] at org.apache.activemq.xbean.XBeanBrokerService.afterPropertiesSet(XBeanBrokerService.java:73)[activemq-spring-5.15.9.jar:5.15.9] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)[:1.8.0_212] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)[:1.8.0_212] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)[:1.8.0_212] at java.lang.reflect.Method.invoke(Method.java:498)[:1.8.0_212] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeCustomInitMethod(AbstractAutowireCapableBeanFactory.java:1763)[spring-beans-4.3.18.RELEASE.jar:4.3.18.RELEASE] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1700)[spring-beans-4.3.18.RELEASE.jar:4.3.18.RELEASE]
      - 2019-11-27 15:09:34,716 | INFO  | Apache ActiveMQ 5.15.9 (localhost, ID:5323986a6080-37033-1572227374550-0:1) is shutting down | org.apache.activemq.broker.BrokerService | main
      - 2019-11-27 15:09:34,718 | INFO  | Connector openwire stopped | org.apache.activemq.broker.TransportConnector | main
      - 2019-11-27 15:09:34,719 | INFO  | Connector amqp stopped | org.apache.activemq.broker.TransportConnector | main
      - 2019-11-27 15:09:34,721 | INFO  | Connector stomp stopped | org.apache.activemq.broker.TransportConnector | main
      - 2019-11-27 15:09:34,722 | INFO  | Connector mqtt stopped | org.apache.activemq.broker.TransportConnector | main
      - 2019-11-27 15:09:34,723 | INFO  | Connector ws stopped | org.apache.activemq.broker.TransportConnector | main
      - 2019-11-27 15:09:34,727 | INFO  | PListStore:[/opt/activemq/data/localhost/tmp_storage] stopped | org.apache.activemq.store.wawa.plist.PListStoreImpl | main
      - 2019-11-27 15:09:34,728 | INFO  | Stopping async queue tasks | org.apache.activemq.store.wawa.KahaDBStore | main
      - 2019-11-27 15:09:34,730 | INFO  | Stopping async topic tasks | org.apache.activemq.store.wawa.KahaDBStore | main
      - 2019-11-29 10:59:49,515 | INFO  | No Spring WebApplicationInitializer types detected on classpath | /admin | main
      - INFO  | anonymous called org.apache.activemq.broker.jmx.QueueView.retryMessages[] at 27-11-2019 08:45:57,213 | qtp443290224-47
      - INFO  | admin called org.apache.activemq.broker.jmx.QueueView.retryMessages[] at 27-11-2019 08:45:57,229 | qtp443290224-45
    engine_outputs:
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,491 | INFO  | KahaDB is version 6 | org.apache.activemq.store.wawa.MessageDatabase | main"}}'
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,531 | INFO  | PListStore:\[/opt/activemq/data/localhost/tmp_storage] started | org.apache.activemq.store.wawa.plist.PListStoreImpl | main"}}'
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,690 | INFO  | Apache ActiveMQ 5.15.9 (localhost, ID:5323986a6080-37033-1572227374550-0:1) is starting | org.apache.activemq.broker.BrokerService | main"}}'
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,712 | ERROR | Failed to start Apache ActiveMQ (localhost, ID:5323986a6080-37033-1572227374550-0:1) | org.apache.activemq.broker.BrokerService | main"}'
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,712 | ERROR | Failed to start Apache ActiveMQ (localhost, ID:5323986a6080-37033-1572227374550-0:1) | org.apache.activemq.broker.BrokerService | mainat org.apache.activemq.util.IOExceptionSupport.create(IOExceptionSupport.java:28)\[activemq-client-5.15.9.jar:5.15.9\]at org.apache.activemq.broker.BrokerService.registerConnectorMBean(BrokerService.java:2264)\[activemq-broker-5.15.9.jar:5.15.9\]at org.apache.activemq.broker.BrokerService.startTransportConnector(BrokerService.java:2744)\[activemq-broker-5.15.9.jar:5.15.9\]at org.apache.activemq.broker.BrokerService.startAllConnectors(BrokerService.java:2640)\[activemq-broker-5.15.9.jar:5.15.9\]at org.apache.activemq.broker.BrokerService.doStartBroker(BrokerService.java:771)\[activemq-broker-5.15.9.jar:5.15.9\]at org.apache.activemq.broker.BrokerService.startBroker(BrokerService.java:733)\[activemq-broker-5.15.9.jar:5.15.9\]at org.apache.activemq.broker.BrokerService.start(BrokerService.java:636)\[activemq-broker-5.15.9.jar:5.15.9\]at org.apache.activemq.xbean.XBeanBrokerService.afterPropertiesSet(XBeanBrokerService.java:73)\[activemq-spring-5.15.9.jar:5.15.9\]at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\[:1.8.0_212\]at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\[:1.8.0_212\]at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\[:1.8.0_212\]at java.lang.reflect.Method.invoke(Method.java:498)\[:1.8.0_212\]at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeCustomInitMethod(AbstractAutowireCapableBeanFactory.java:1763)\[spring-beans-4.3.18.RELEASE.jar:4.3.18.RELEASE\]at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1700)\[spring-beans-4.3.18.RELEASE.jar:4.3.18.RELEASE\]"}}'
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,716 | INFO  | Apache ActiveMQ 5.15.9 (localhost, ID:5323986a6080-37033-1572227374550-0:1) is shutting down | org.apache.activemq.broker.BrokerService | main"}}'
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,718 | INFO  | Connector openwire stopped | org.apache.activemq.broker.TransportConnector | main"}}'
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,719 | INFO  | Connector amqp stopped | org.apache.activemq.broker.TransportConnector | main"}}'
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,721 | INFO  | Connector stomp stopped | org.apache.activemq.broker.TransportConnector | main"}}'
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,722 | INFO  | Connector mqtt stopped | org.apache.activemq.broker.TransportConnector | main"}}'
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,723 | INFO  | Connector ws stopped | org.apache.activemq.broker.TransportConnector | main"}}'
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,727 | INFO  | PListStore:\[/opt/activemq/data/localhost/tmp_storage\] stopped | org.apache.activemq.store.wawa.plist.PListStoreImpl | main"}}'
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,728 | INFO  | Stopping async queue tasks | org.apache.activemq.store.kahaasddb.KahaDBStore | main"}}'
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,730 | INFO  | Stopping async topic tasks | org.apache.activemq.store.wawa.KahaDBStore | main"}}'
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-29 10:59:49,515 | INFO  | No Spring WebApplicationInitializer types detected on classpath | /admin | main"}}'
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"INFO  | anonymous called org.apache.activemq.broker.jmx.QueueView.retryMessages\[\] at 27-11-2019 08:45:57,213 | qtp443290224-47"}}'
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"INFO  | admin called org.apache.activemq.broker.jmx.QueueView.retryMessages\[\] at 27-11-2019 08:45:57,229 | qtp443290224-45"}}'

- name: UNICODE logs
  description: Verify that the engine accepts unicode characters sample logs
  configuration_parameters:
    cfg: None
  metadata:
    events:
      - "\u0054\u0045\u0053\u0054\u0049\u004E\u0047"
      - "a log \0with unicode null"
      - "a log \nwith new line"
    engine_outputs:
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"TESTING"}}'
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"a log "}}'
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"a log \\nwith new line"}}'

- name: cisco ios logs
  description: Verify that the engine accepts cisco ios sample logs
  configuration_parameters:
    cfg: None
  metadata:
    events:
      - 'Feb  8 04:00:48 198.51.100.2 585917: Feb  8 04:00:47.272: %SEC-6-IPACCESSLOGRP: list 177 denied igmp 198.51.100.197 -> 224.0.0.22, 1 packet'
    engine_outputs:
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"Feb  8 04:00:48 198.51.100.2 585917: Feb  8 04:00:47.272: %SEC-6-IPACCESSLOGRP: list 177 denied igmp 198.51.100.197 -> 224.0.0.22, 1 packet","start":"2023-02-08T04:00:48.000Z","kind":"event"},"host":{"hostname":"198.51.100.2"},"process":{"name":"585917"},"message":"Feb  8 04:00:47.272: %SEC-6-IPACCESSLOGRP: list 177 denied igmp 198.51.100.197 -> 224.0.0.22, 1 packet","related":{"hosts":\["198.51.100.2"]}}'

- name: JSON logs
  description: Verify that the engine accepts JSON sample logs
  configuration_parameters:
    cfg: None
  metadata:
    events:
      - '{"timestamp":"2022-12-13T16:29:16.782+0000","rule":{"level":3,"description":"New dpkg (Debian Package) requested to install.","id":"2901","firedtimes":1,"mail":false,"groups":["syslog","dpkg"],"pci_dss":["10.6.1"],"gpg13":["4.10"],"gdpr":["IV_35.7.d"],"hipaa":["164.312.b"],"nist_800_53":["AU.6"],"tsc":["CC7.2","CC7.3","CC8.1"]},"agent":{"id":"000","name":"engine"},"manager":{"name":"engine"},"id":"1670948956.240","full_log":"2022-12-13 16:29:16 install filebeat:amd64 <none> 7.10.2","decoder":{"name":"dpkg-decoder"},"data":{"dpkg_status":"install","package":"filebeat","arch":"amd64","version":"<none>"},"location":"/var/log/dpkg.log"}'
    engine_outputs:
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"{\\"timestamp\\":\\"2022-12-13T16:29:16.782\+0000\\",\\"rule\\":{\\"level\\":3,\\"description\\":\\"New dpkg \(Debian Package\) requested to install.\\",\\"id\\":\\"2901\\",\\"firedtimes\\":1,\\"mail\\":false,\\"groups\\":\[\\"syslog\\",\\"dpkg\\"],\\"pci_dss\\":\[\\"10.6.1\\"],\\"gpg13\\":\[\\"4.10\\"],\\"gdpr\\":\[\\"IV_35.7.d\\"],\\"hipaa\\":\[\\"164.312.b\\"],\\"nist_800_53\\":\[\\"AU.6\\"],\\"tsc\\":\[\\"CC7.2\\",\\"CC7.3\\",\\"CC8.1\\"]},\\"agent\\":{\\"id\\":\\"000\\",\\"name\\":\\"engine\\"},\\"manager\\":{\\"name\\":\\"engine\\"},\\"id\\":\\"1670948956.240\\",\\"full_log\\":\\"2022-12-13 16:29:16 install filebeat:amd64 <none> 7.10.2\\",\\"decoder\\":{\\"name\\":\\"dpkg-decoder\\"},\\"data\\":{\\"dpkg_status\\":\\"install\\",\\"package\\":\\"filebeat\\",\\"arch\\":\\"amd64\\",\\"version\\":\\"<none>\\"},\\"location\\":\\"/var/log/dpkg.log\\"}"},"~json":{"timestamp":"2022-12-13T16:29:16.782\+0000","rule":{"level":3,"description":"New dpkg \(Debian Package\) requested to install.","id":"2901","firedtimes":1,"mail":false,"groups":\["syslog","dpkg"],"pci_dss":\["10.6.1"],"gpg13":\["4.10"],"gdpr":\["IV_35.7.d"],"hipaa":\["164.312.b"],"nist_800_53":\["AU.6"],"tsc":\["CC7.2","CC7.3","CC8.1"]},"agent":{"id":"000","name":"engine"},"manager":{"name":"engine"},"id":"1670948956.240","full_log":"2022-12-13 16:29:16 install filebeat:amd64 <none> 7.10.2","decoder":{"name":"dpkg-decoder"},"data":{"dpkg_status":"install","package":"filebeat","arch":"amd64","version":"<none>"},"location":"/var/log/dpkg.log"}}'

- name: elasticsearch logs
  description: Verify that the engine accepts elasticsearch sample logs
  configuration_parameters:
    cfg: None
  metadata:
    events:
      - '[2018-05-17T08:29:12,177][INFO ][o.e.c.m.MetaDataCreateIndexService] [vWNJsZ3] [test-filebeat-modules] creating index, cause [auto(bulk api)], templates [test-filebeat-modules], shards [5]/[1], mappings [doc]'
    engine_outputs:
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"\[2018-05-17T08:29:12,177]\[INFO ]\[o.e.c.m.MetaDataCreateIndexService] \[vWNJsZ3] \[test-filebeat-modules] creating index, cause \[auto\(bulk api\)], templates \[test-filebeat-modules], shards \[5]/\[1], mappings \[doc]"}}'

- name: auditd logs
  description: Verify that the engine accepts auditd sample logs
  configuration_parameters:
    cfg: None
  metadata:
    events:
      - 'node=localhost.localdomain type=DAEMON_START msg=audit(1594053514.588:4686): op=start ver=2.8.5 format=raw kernel=3.10.0-1062.9.1.el7.x86_64 auid=4294967295 pid=1643 uid=0 ses=4294967295 subj=system_u:system_r:auditd_t:s0 res=success'
    engine_outputs:
      - '{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"node=localhost.localdomain type=DAEMON_START msg=audit\(1594053514.588:4686\): op=start ver=2.8.5 format=raw kernel=3.10.0-1062.9.1.el7.x86_64 auid=4294967295 pid=1643 uid=0 ses=4294967295 subj=system_u:system_r:auditd_t:s0 res=success"}}'
